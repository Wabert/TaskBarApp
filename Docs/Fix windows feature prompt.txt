I would like you to analyze and fx a new feature for my suiteView taskbar app.  Please review the latest code for our project in Project Files. The feature im trying to implement is:

I would like another button added that says "Windows".  When this button is clicked a menu shows up which lists all of the current windows open, visible or invisible.  I only want to see relevant windows, that is windows for apps that Ive opened like Word, Excel, Teams, Notepad, Chrome, File Explorer and so one.  I would like the list to be organized by app where approprieate.  For example, if i have mulitple workbooks open in Excel, I want to see EXCEL as the main line and the all the workbooks listed under it.  Same for Notepad or chrome or word, etc...  I want the list to be interactive in that if i click on an item it will toggle between hidding and unhidding the window, and the list item color should be different to indicate if that window is currently hidden or visible.  If i double click an item i want that window to close.  As windows are hidden and unhidden, the list item color should be upateded (please user our color theme).  There should be a refresh button on the menu that refresh and pickup any new open windows or drop closed windows.  The refresh should not change the current visisble state of the existing windows.   Please keep the look and feel and color scheme of the menu consistant with the other menus.  I also want the ability to pin and unpin windows.  Pinning a window should move it to a new column that is titled "Pinned".  Otherwise the structure of the windows in the Pinned column should be the same as the first column.  A pinned window should be allowed to be unpinned which will put it back with the rest of the windows in the original main column.  And then i want to have a "Show Pinned" button and a "Show All" button at the bottom of the whole menu.  When the Show Pinned button is clicked all the pinned windows become visible and all unpinned windows become invisible.  When i click the Show All button all all windows become visisble Im trying to create a feature that will let me easily manage many open windows so i can display only what im working on at the time.  There are 3 .py  files that we have so far to manage this feature, they are:  windows_api.py, windows_manager.py, windows_menu.py.  But its not all working correctly.  One problem is that when i click Show Pinned, all the unpinned windows drop from the menu.  They shouldn't do that, they should just show that they are hidden.  And then when i click Show All none of those windows become visisble again.  Please analyse the code to spot this and any other issues and write the revisted code for the fix. If you need to add additional files thats ok. thank you